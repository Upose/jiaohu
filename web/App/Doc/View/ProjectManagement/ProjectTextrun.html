<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="__DOCLAY__/plugins/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="__CSS__/ProjectTextrun.css" media="all">
		<link rel="stylesheet" href="__CSS__/ProjectCollectiontitle.css" media="all">	
    <script src="__STATIC__/jquery-2.0.3.min.js"></script>
	<script src="__STATIC__/vue.min.js"></script>
</head>

<body id="app" >
    <div id="event-view">
			<div class="details_gao">
				<blockquote class="layui-elem-quote">项目里程碑</blockquote>
				<div class="layui-row layui-col-space1">
					<div class="layui-col-md2">
						<div class="grid-demo">
								<img  src="/Public/Doc/images/user.png" alt="">							
						</div>
						<div class="style-agile-border">
						<img  src="/Public/Doc/images/sty1.png" alt="">
						</div>
						<div class="layui_code">商务/售前</div>
					</div>
					<div class="layui-col-md2">
						<div class="grid-demo">
						<ul>
							<li class="layui-tab-zi">
								<a href="{:U('ProjectManagement/ProjectDisplay')}">
								  <h3 class="layui-cite">项目信息</h3>
								</a>
							</li>
							<li class="layui-tab-zi layui-tab-top">
								<a href="{:U('ProjectManagement/ProjectApproval')}">
								<h3 class="layui-cite">立项</h3>
								</a>
							</li>
							<li class="layui-tab-zi layui-tab-top">
								<a href="{:U('ProjectManagement/ProjectCollection')}">
								<h3 class="layui-cite">项目成员</h3>
								</a>
							</li>
							<li class="layui-tab-zi layui-tab-top">
								<a href="{:U('ProjectManagement/ProjectCustomer')}">
								<h3 class="layui-cite">客户关系</h3>
								</a>
							</li>
						</ul>
						</div>
						<div class="style-agile-border">
						<img  src="/Public/Doc/images/sty1.png" alt="">
						</div>
						<div class="layui_code">启动</div>
					</div>
					<div class="layui-col-md2">
						<div class="grid-demo">
							<ul>
							<li class="layui-tab-zhong">
								<a href="{:U('Feedback/index')}">
								<h3 class="layui-cite">里程碑计划</h3>
								</a>
							</li>
							<li class="layui-tab-zhong layui-tab-top">
								<a href="{:U('ProjectManagement/ProjectWeekPlan')}">
								<h3 class="layui-cite">工作计划</h3>
								</a>
							</li>
						</ul>
						</div>
						<div class="style-agile-border">
						<img  src="/Public/Doc/images/sty1.png" alt="">
						</div>
						<div class="layui_code">计划管理</div>
					</div>
					<div class="layui-col-md2">
						<div class="grid-demo">
						<ul>
							<li class="layui-tab-zi">
								<a href="{:U('Feedback/index')}">
								<h3 class="layui-cite">周报管理</h3>
								</a>
							</li>
							<li class="layui-tab-zi layui-tab-top">
								<a href="{:U('ProjectManagement/ProjectMinutes')}">
								<h3 class="layui-cite">会议管理</h3>
								</a>
							</li>
							<li class="layui-tab-zi layui-tab-top">
								<a href="{:U('ProjectManagement/Projectrisk')}">
								<h3 class="layui-cite">风险管理</h3>
								</a>
							</li>
							<li class="layui-tab-zi layui-tab-top">
								<a href="{:U('ProjectManagement/ProjectEvent')}">
								<h3 class="layui-cite">事件管理</h3>
								</a>
							</li>
						</ul>
						</div>
						<div class="style-agile-border">
						<img  src="/Public/Doc/images/sty1.png" alt="">
						</div>
						<div class="layui_code">执行管理</div>
					</div>
					<div class="layui-col-md2">
						<div class="grid-demo">
						<ul>
							<li class="layui-tab-zhonging">
								<a href="{:U('ProjectManagement/ProjectText')}">
								<h3 class="layui-cite">测试报告</h3>
								</a>
							</li>
						</ul>
						</div>
						<div class="style-agile-border">
						<img  src="/Public/Doc/images/sty1.png" alt="">
						</div>
						<div class="layui_code">测试联调</div>
					</div>
					<div class="layui-col-md2">
						<div class="grid-demo">
						<ul>
							<li class="layui-tab-zhonging layui-red">
								<a href="{:U('ProjectManagement/ProjectTextrun')}">
								<h3 class="layui-cite">试运行记录</h3>
								</a>
							</li>
						</ul>
						</div>
						<div class="style-agile-border">
						<img  src="/Public/Doc/images/sty1.png" alt="">
						</div>
						<div class="layui_code">试运行</div>
					</div>
					<div class="layui-col-md2">
						<div class="grid-demo">						
						<ul>
							<li class="layui-tab-zhongpp">
								<a href="{:U('ProjectManagement/ProjectAcceptance')}">
								<h3 class="layui-cite">项目验收</h3>
								</a>
							</li>
							<li class="layui-tab-zhongpp layui-tab-top">
								<a href="{:U('KnowledgeSharing/index')}">
								<h3 class="layui-cite">成员考勤</h3>
								</a>
							</li>
							<li class="layui-tab-zhongpp layui-tab-top">
								<a href="{:U('KnowledgeSharing/index')}">
								<h3 class="layui-cite">成员考核</h3>
								</a>
							</li>
						</ul>
						</div>
						<div class="layui_code">验收归档</div>
					</div>
				</div>
			</div>
			<div class="details_zhong">
				<div class="layui-row">
					<div class="layui-col-md12">
					<blockquote class="layui-elem-quote addThispro">试运行信息列表</blockquote>
					<button class="addThisPeo" lay-filter="addThisPeo">新增试运行</button>
					</div>
					<div class="layui-col-md12">
					<table class="layui-hide" id="peoples" lay-filter="peoples"></table>
					</div>
				</div>
		</div>
		</div>
		<!-- 新增功能弹框 -->
		<div class="layui-row" id="addPeople" style="display: none;padding: 20px 30px;">
			<div class="layui-col-md10">
					<form class="layui-form" id="addEmployeeForm">
							<div class="layui-form-item">
									<label class="layui-form-label">项目名称：</label>
									<div class="layui-input-block">
											<input type="text" name="conpany" class="layui-input" lay-verify="required">
									</div>
							</div>
							<div class="layui-form-item">
									<label class="layui-form-label">试运内容：</label>
									<div class="layui-input-block">
											<input type="text" name="con_nr" class="layui-input" lay-verify="required">
									</div>
							</div>
							<div class="layui-form-item">
									<label class="layui-form-label">试运情况：</label>
									<div class="layui-input-block">
											<input type="text" name="con_qk" class="layui-input" lay-verify="required">
									</div>
							</div>
							<div class="layui-form-item">
									<label class="layui-form-label">用户评价：</label>
									<div class="layui-input-block">
											<input type="text" name="con_pj" class="layui-input" lay-verify="required">
									</div>
							</div>
							<div class="layui-form-item">
									<label class="layui-form-label">开始时间：</label>
									<div class="layui-input-block">
										<input type="text" class="layui-input" id="test1" placeholder="yyyy年MM月dd日">
									</div>
							</div>
							<div class="layui-form-item">
									<label class="layui-form-label">结束时间：</label>
									<div class="layui-input-block">
											<input type="text" class="layui-input" id="test2" placeholder="yyyy年MM月dd日">
									</div>
							</div>
							<div class="layui-form-item">
									<label class="layui-form-label">达成目标：</label>
									<div class="layui-input-block">
												<input type="text" name="con_mb" class="layui-input" lay-verify="required">
									</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">文件上传：</label>
								<button type="button" class="layui-btn layui-btn-sm" id="upwenjian">
									<i class="layui-icon">&#xe67c;</i>添加附件
								</button>
								<button type="button" class="layui-btn layui-btn-sm" id="uploadBtn">
										<i class="layui-icon">&#xe67c;</i>上传文件
								</button>
								<span id="fileName"></span>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">相关备注：</label>
								<div class="layui-input-block">
									<textarea name="textject" placeholder="" class="layui-textarea"></textarea>
								</div>
							</div>
							<div class="layui-form-item">
								<div class="layui-input-block">
									<button class="layui-btn" lay-submit="" lay-filter="demoone">提交</button>
									<button type="reset" class="layui-btn layui-btn-primary">重置</button>
								</div>
							</div>	
					</form>
			</div>
	</div>
</body>
<script src="__DOCLAY__/plugins/layui/layui.js"></script>
<script>
	var  uptext;

	layui.use(['form', 'layedit', 'laydate','table'], function(){
		var form = layui.form,
		layer = layui.layer,
		layedit = layui.layedit,
		laydate = layui.laydate;
		var table = layui.table;
	//开始运行日期 
		laydate.render({
			elem: '#test1'
			});
	//结束时间
		laydate.render({
			elem: '#test2'
			});
			
			form.on('submit(demoone)', function(data){	
				var s_time=$("#test1").val(); 
				var e_time=$("#test2").val(); 
				$.ajax({
				url:"{:U('ItemTestRun/testRunAdd')}",
				type: 'post',
				data: {
							pro_code:"12",  //  项目id  后期添加
							content:data.field.con_nr,
							situation:data.field.con_qk,
							evaluate :data.field.con_pj,
							start_time:s_time,
							stop_time:e_time,
							target:data.field.con_mb,
							founder_id :'2222',  //后期登录后添加
							remarks:data.field.textject,
							enclosure:uptext,
				},
				dataType: 'json',
				success: function(res) {
						if(res.code == 200) {
							layui.use('layer', function() {
								layer.alert('提交成功');
							})
						} else {
							layui.use('layer', function() {
								var layer = layui.layer;
								layer.alert('添加失败');
							})
						}			
				},
				})
				return false;
			});	
});
		// 文件上传
		layui.use('upload', function(){
			var upload = layui.upload;			 
			//执行实例  但不执行上传功能
			var uploadInst = upload.render({
				elem: '#upwenjian', //绑定元素
				url: "{:U('ItemAcceptance/fileUpload')}", //上传接口
				accept:'file',
				auto: false, 
				bindAction: '#uploadBtn',
				choose: function(obj) {
					obj.preview(function(index, file, result) {
						$("#fileName").html(file.name);
					});
				},
				done: function(res) {
					uptext =res.data.src;
					console.log(uptext);
					layer.msg(res.msg);
				}
			});
		});
		
		// 添加项目组成员
		$('.addThisPeo').on('click',function(){
				layer.open({
						type: 1,
						title: '新增试运行',
						closeBtn: 2,   // 关闭样式
						shadeClose: true,  // 关闭方式
						anim:5,    // 弹出样式
						area: ['36vw', '90vh'],
						// btn:['确定','取消'],
						isOutAnim:false,    // 关闭动画
						content: $('#addPeople'),
				})
		}); 
				

</script>
</html>